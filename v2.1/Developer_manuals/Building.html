<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Building ETF</title>
<link rel="stylesheet" href="../stylesheets/etf.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="shortcut icon" href="../images/favicon.ico" type="image/vnd.microsoft.icon" />
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of contents</div>
<ul class="sectlevel0">
<li><a href="#_building_etf">Building ETF</a>
<ul class="sectlevel1">
<li><a href="#_changelog">Changelog</a></li>
<li><a href="#_about_etf">About ETF</a></li>
<li><a href="#_prerequisites">Prerequisites</a></li>
<li><a href="#_accessing_the_source_code">Accessing the source code</a></li>
<li><a href="#_compiling_the_source_code">Compiling the source code</a></li>
<li><a href="#_including_test_drivers_to_the_web_application">Including Test drivers to the web application</a></li>
<li><a href="#_running_the_web_application">Running the web application</a></li>
<li><a href="#_building_other_etf_components">Building other ETF components</a></li>
<li><a href="#_test_driver_development">Test driver development</a></li>
<li><a href="#_faq">FAQ</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><a class="image" href="http://www.etf-validator.net"><img src="http://docs.etf-validator.net/v2.0/images/ETF_logo.png" alt="ETF Logo" width="125"></a></span></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><span class="etf_headline"><strong>ETF</strong><br>
Testing framework for spatial data and services</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h1 id="_building_etf" class="sect0">Building ETF</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-topbot grid-none stretch">
<colgroup>
<col style="width: 25%;">
<col style="width: 75%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">not approved</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022-08-17</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This manual describes how to build the ETF validator. Knowledge about maven, maven repositories and build management tools are required.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target audience</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Developers planning to build the ETF validator themselves</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution (cc-by) 4.0</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Identifier</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://docs.etf-validator.net/v2.0/Developer_manuals/Building.html" class="bare">https://docs.etf-validator.net/v2.0/Developer_manuals/Building.html</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Language</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EN</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_changelog">Changelog</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 50.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Date</strong></th>
<th class="tableblock halign-left valign-top"><strong>Editor</strong></th>
<th class="tableblock halign-left valign-top"><strong>Comments</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2017-05-02</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jon Herrmann</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">document created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2017-06-21</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Clemens Portele</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">editorial updates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2017-07-12</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jon Herrmann</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Test driver development section</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">2022-08-17</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Guadaltel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Updated to v2.1</p></td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
<!-- toc disabled -->
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_about_etf">About ETF</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="http://etf-validator.net">ETF</a> is an open source testing framework for validating spatial data, metadata and web services in Spatial Data Infrastructures (SDIs). It can be used via a responsive web application or via a REST API.</p>
</div>
<div class="paragraph">
<p>The design of ETF is driven by three goals: be user-friendly, consistent with the standards and capable of testing all resources in an SDI.</p>
</div>
<div class="paragraph">
<p><a href="http://www.interactive-instruments.de/">interactive instruments</a> has developed ETF and is the primary maintainer of the software.</p>
</div>
<div class="paragraph">
<p><a href="http://docs.etf-validator.net/">More documentation about ETF&#8230;&#8203;</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prerequisites">Prerequisites</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://jdk.java.net/archive/">OpenJDK 11 is installed</a></p>
</li>
<li>
<p>Ensure JAVA_HOME environment variable is set</p>
</li>
<li>
<p><a href="https://git-scm.com/downloads">Git installed</a></p>
</li>
<li>
<p><a href="https://www.eclipse.org/jetty/download.php">Jetty 9 installed</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_accessing_the_source_code">Accessing the source code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The already compiled .war archive in <a href="https://github.com/etf-validator/etf-webapp/releases/tag/2.1.0-rc.1">etf-webapp.war</a></p>
</div>
<div class="paragraph">
<p>However you can compile it youself. For this option, the code base of the web application can be cloned from <a href="https://github.com/etf-validator/etf-webapp">GitHub</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
because the ETF version 2.1 is not finally released, the next branch must be used.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">git clone -b next https://github.com/etf-validator/etf-webapp.git</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compiling_the_source_code">Compiling the source code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ETF uses <a href="https://gradle.org">Gradle</a> as build management tool. The gradle
wrapper script will automatically download the required Gradle version and
start the build process afterwards.</p>
</div>
<div class="paragraph">
<p>Dependencies are downloaded from the interactive instruments repositories.
Currently only the snapshot repository can be accessed with the credentials
etf-public-dev / etf-public-dev . This is automatically done by
default.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The repository to be used is determined from the version.properties file.
Make sure the version is suffixed with "-SNAPSHOT". If necessary, change the
version in the version.properties file, for example to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>version = 2.1.0-SNAPSHOT</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">On a Windows command line run</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cmd">C:\etf-webapp&gt; gradlew.bat build</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Linux execute</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">$ ./gradlew build install spotlessApply -x test</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_including_test_drivers_to_the_web_application">Including Test drivers to the web application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The test drivers are not included by default in the etf-webapp. So, to be able to use them and have access to all the tests that ETF offer, they should be added before the run of the web application. To do so you can download them already built or bouild them yourselves. For the first option they can be download using these links:</p>
</div>
<div class="paragraph">
<p>To build them yourself, first they should be cloned from these links:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/etf-validator/etf-bsxtd.git">etf-bsxtd</a> ETF test driver for running BaseX XQuery based test projects</p>
</li>
<li>
<p><a href="https://github.com/etf-validator/etf-tetd.git">etf-tetd</a> ETF test driver for executing Test Suites on a remote OGC TEAM Engine instance</p>
</li>
<li>
<p><a href="https://github.com/etf-validator/etf-suitd.git">etf-suitd</a> ETF test driver for running SoapUI based test projects</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Test drivers then should be built with the following commands:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For etf-bsxtd:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">On a Windows command line run</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cmd">C:\etf-webapp&gt; gradlew.bat build install</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Linux execute</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">$ ./gradlew build install</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For etf-suitd:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">On a Windows command line run</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cmd">C:\etf-webapp&gt; gradlew.bat build install -x test</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Linux execute</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">$ ./gradlew build install -x test</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For etf-tetd:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">On a Windows command line run</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="cmd">C:\etf-webapp&gt; gradlew.bat build install spotlessApply -x test</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">On Linux execute</div>
<div class="content">
<pre class="pygments highlight"><code data-lang="bash">$ ./gradlew build install spotlessApply -x test</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Option "-x test" skips tests, while "spotlessApply" solves issues regarding code formatting.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>After you have the compiled .jar archives, in order to deploy the ETF, we have to start from etf-webapp and create a folder named "testdrivers" inside the war file where to place the previous compilated .jar files (etf-suitd-legacy-2.1.0-SNAPSHOT.jar, etf-tetd-1.1.0-SNAPSHOT.jar, etf-bsxtd-legacy-2.1.0-SNAPSHOT.jar) in it.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_the_web_application">Running the web application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Copy the etf-webapp.war file to JETTY_HOME/webapps or if you have created a JETTY_BASE, then copy the etf-webapp.war file to JETTY_BASE/webapps.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The default JETTY_HOME is located at <strong>/usr/share/jetty9</strong>. In case you downloaded it form a browser, JETTY_HOME would be where are the folders containing jetty9.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Initiate Jetty 9 using <strong>java -jar start.jar</strong> in JETTY_HOME or JETTY_BASE, in case you have one. If it doesn&#8217;t work you can use <strong>JETTY_HOME/bin/jetty.sh start</strong> or <strong>JETTY_HOME/bin/jetty.sh run</strong>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If issues arise in the deployment, we probably need to manually add the following libraries to etf-webapp.war/WEB-INF/lib/ in order to make the deployment work properly:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://repo1.maven.org/maven2/org/bouncycastle/bcprov-jdk18on/1.71/bcprov-jdk18on-1.71.jar">bcprov-jdk18on-171.jar</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/org/apache/flex/blazeds/flex-messaging-core/4.7.3/flex-messaging-core-4.7.3.jar">flex-messaging-core-4.7.3.jar</a></p>
</li>
<li>
<p><a href="https://repo.b3p.nl/nexus/repository/public/com/btr/proxy-vole/20131209/proxy-vole-20131209.jar">proxy-vole-20131209.jar</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/wsdl4j/wsdl4j/1.6.2/wsdl4j-1.6.2.jar">wsdl4j-1.6.2.jar</a></p>
</li>
<li>
<p><a href="https://repo1.maven.org/maven2/xmlunit/xmlunit/1.6/xmlunit-1.6.jar">xmlunit-1.6.jar</a></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The web application can then be accessed at <a href="http://localhost:8080">http://localhost:8080/etf-webapp</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To stop the process in case of using <strong>java -jar start.jar</strong> or <strong>JETTY_HOME/bin/jetty.sh run</strong>, use <strong>CTRL+C</strong>. In case of using <strong>JETTY_HOME/bin/jetty.sh start</strong>, use <strong>JETTY_HOME/bin/jetty.sh stop</strong>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_other_etf_components">Building other ETF components</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The web application depends on several other ETF components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/etf-validator/etf-core">etf-core</a> ETF core library including API and domain model</p>
</li>
<li>
<p><a href="https://github.com/etf-validator/etf-spi">etf-spi</a> ETF Service Provider Interface</p>
</li>
<li>
<p><a href="https://github.com/etf-validator/etf-bsxds">etf-bsxds</a> ETF data storage based on the BaseX database</p>
</li>
<li>
<p><a href="https://github.com/etf-validator/etf-sui-ae">etf-sui-ae</a> ETF test driver adapter and extensions for SoapUI</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The source code of the components must be cloned using GIT
(otherwise a 'repository not found' error occurs).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
because the ETF version 2.1 is not finally released, the next branches must be used.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Changed components can be installed into the local maven repository with the
gradle <strong>install</strong> command and be used by the etf-webapp component afterwards.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_driver_development">Test driver development</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Test drivers are released with the ETF web application. There are integrated
into the WAR file and extracted into the test driver directory at start up,
depending on the version numbers of existing test drivers. If the integrated
test drivers have a higher version number then the test drivers in the test
driver directory, the old test drivers are deleted and the new test drivers
are deployed and used.</p>
</div>
<div class="paragraph">
<p>This mechanism allows to update test drivers without redeploying the whole web
application.</p>
</div>
<div class="paragraph">
<p>If you are either developing and testing a test driver without changing the
version number or you are using a newer snapshot test driver, make sure the
latest test driver is deployed into the test driver directory.</p>
</div>
<div class="paragraph">
<p>This means that you need to manually overwrite the test driver or use the
<code>gradle install</code> task in the test driver project. To correctly run the
install task, you need to set the 'etf.td.deployment.dir' gradle property,
for example in the settings.gradle or in the system gradle.properties.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_faq">FAQ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Q: I get a <code>repository not found</code> error.</p>
</div>
<div class="paragraph">
<p>A: The error occurs for example if the source code has been downloaded and not
cloned with GIT -or the directory has been copied without the hidden .git
directory. The build helper script (etf-bda) collects information from the
locally cloned GIT repository and includes the property <code>Implementation-Revision</code>
in the manifest file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Manifest-Version: 1.0
Build-Date: 170601013212
Implementation-Version: 2.0.0
Build-Gradle: 3.5
Build-ii-bda: 1.0.24.1
Implementation-Revision: abf509f
Source-Compatibility: 1.8
Implementation-Build: 0
Build-Host: JAX
Build-User: herrmann
Build-JDK: 1.8.0_102</pre>
</div>
</div>
<div class="paragraph">
<p>You can fix the problem by cloning the repository from GitHub using GIT.</p>
</div>
<hr>
<div class="paragraph small">
<p><a href="https://www.interactive-instruments.de/en/about/impressum/">Legal Notice</a> | <a href="https://www.interactive-instruments.de/en/about/datenschutzerklarung/">Privacy Notice</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-08-19 14:46:27 +0200
</div>
</div>
</body>
</html>